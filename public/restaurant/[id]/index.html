<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    // Récupérer l'ID du restaurant
    const pathSegments = window.location.pathname.split('/').filter(p => p);
    const restaurantId = pathSegments[pathSegments.length - 1];
    
    // Détecter la plateforme
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
    const isAndroid = /Android/.test(navigator.userAgent);
    
    // URLs
    const deepLinkUrl = `https://butter-universal-links-config.vercel.app/restaurant/${restaurantId}`;
    const iosAppStoreUrl = 'https://apps.apple.com/fr/app/butter-guide-de-restaurants/id6749227938';
    const androidPlayStoreUrl = 'https://play.google.com/store/apps/details?id=com.tasenviedequoi.butter';
    
    // Tenter d'ouvrir l'app
    const startTime = Date.now();
    let blurred = false;
    
    window.addEventListener('blur', () => { blurred = true; });
    
    // Essayer d'ouvrir l'app via Universal Links / App Links
    window.location.href = deepLinkUrl;
    
    // Après 2 secondes, si l'app ne s'est pas ouverte, rediriger vers le store
    setTimeout(() => {
      if (!blurred) {
        if (isIOS) {
          window.location.href = iosAppStoreUrl;
        } else if (isAndroid) {
          window.location.href = androidPlayStoreUrl;
        }
      }
    }, 2000);
  </script>
</head>
<body>
  <div style="text-align: center; padding: 50px; font-family: system-ui;">
    <p>Redirection en cours...</p>
  </div>
</body>
</html>
